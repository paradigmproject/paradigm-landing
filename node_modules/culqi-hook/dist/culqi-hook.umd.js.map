{"version":3,"file":"culqi-hook.umd.js","sources":["../src/culqi.js"],"sourcesContent":["import { useState } from \"react\";\n\nconst CULQI_CHECKOUT = \"https://checkout.culqi.com\";\n\n/**\n * This hook returns a simple array with two or three options, first: your token generation result,\n * second: your trigger to generate token and finally (and optional) your ready state\n *\n * _Heads up:_ This will make your component render on every navigation unless you set this hook to passive!\n * @param {string} publicKey Pass your public key extracted from your culqi dashboard (e.g. pk_test_POQJOT184VO1HOkc)\n * @returns {[{ready: Boolean, loading:Boolean, error: {message: string, userMessage: string}, token: string}, Function]}\n */\n\nexport const useCulqi = publicKey => {\n  const [response, setResponse] = useState({ ready: false });\n\n  const [f, _] = useState(document.createElement(\"iframe\"));\n\n  if (!response.ready) {\n    f.style.display = \"none\";\n    f.setAttribute(\n      \"src\",\n      CULQI_CHECKOUT +\n        \"/?public_key=\" +\n        publicKey +\n        \"&title=Q3VscWkgU3RvcmU%3D&currency=UEVO&\" +\n        \"description=UG9sbyBDdWxxaSBsb3Zlcg%3D%3D&\" +\n        \"amount=MzUwMA%3D%3D&logo=aHR0cHM6Ly9zdGF0aWM\" +\n        \"uY3VscWkuY29tL3YyL3YyL3N0YXRpYy9pbWcvbG9nby5wbmc%3D&\" +\n        \"installments=false&orders=\"\n    );\n\n    document.body.appendChild(f);\n    window.addEventListener(\n      \"message\",\n      function receive(evt) {\n        if (evt.origin === CULQI_CHECKOUT) {\n          if (evt.data.object) {\n            if (evt.data.object === \"token\") {\n              setResponse({\n                ...response,\n                token: evt.data.id,\n                loading: false,\n                ready: true\n              });\n            } else {\n              if (evt.data.object === \"error\") {\n                setResponse({\n                  ...response,\n                  error: {\n                    message: evt.data.merchant_message,\n                    userMessage: evt.data.user_message\n                  },\n                  ready: true,\n                  loading: false\n                });\n              }\n            }\n          }\n        }\n      },\n      false\n    );\n\n    f.addEventListener(\"load\", function() {\n      setResponse({ ...response, ready: true });\n\n      f.contentWindow.postMessage(\n        {\n          _publicKey: publicKey,\n          _settings: {\n            title: \"Culqi Store\",\n            currency: \"PEN\",\n            description: \"Polo Culqi lover\",\n            amount: 3500,\n            version: \"2\"\n          },\n          _options: {\n            lang: \"auto\",\n            modal: !0,\n            onlyInputs: !1,\n            head: !0,\n            installments: !1,\n            customButton: \"\",\n            style: {\n              bgcolor: \"#fafafa\",\n              maincolor: \"#0ec1c1\",\n              disabledcolor: \"#ffffff\",\n              buttontext: \"#ffffff\",\n              maintext: \"#4A4A4A\",\n              desctext: \"#4A4A4A\",\n              logo: \"https://static.culqi.com/v2/v2/static/img/logo.png\"\n            }\n          }\n        },\n        \"*\"\n      );\n    });\n  }\n\n  const generateToken = details => {\n    if (response.ready) {\n      setResponse({ ...response, loading: true });\n      f.contentWindow.postMessage(\n        {\n          type: \"createToken\",\n          card_number: details.cardNumber,\n          email: details.email,\n\n          cvv: details.cvv,\n          expiration_year: details.expirationYear,\n          expiration_month: details.expirationMonth\n        },\n        \"*\"\n      );\n    }\n  };\n\n  return [response, generateToken];\n};\n"],"names":["const","CULQI_CHECKOUT","useCulqi","publicKey","useState","ready","response","setResponse","document","createElement","f","style","display","setAttribute","body","appendChild","window","addEventListener","receive","evt","origin","data","object","token","id","loading","error","message","merchant_message","userMessage","user_message","contentWindow","postMessage","_publicKey","_settings","title","currency","description","amount","version","_options","lang","modal","onlyInputs","head","installments","customButton","bgcolor","maincolor","disabledcolor","buttontext","maintext","desctext","logo","generateToken","details","type","card_number","cardNumber","email","cvv","expiration_year","expirationYear","expiration_month","expirationMonth"],"mappings":"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"}